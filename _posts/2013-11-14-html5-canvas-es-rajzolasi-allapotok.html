---
layout: post
title: HTML5 canvas és a Rajzolási állapotok
date: '2013-11-14T16:34:00.001-08:00'
author: Stryker
tags: 
modified_time: '2013-11-16T09:27:01.419-08:00'
---

Végül eljött az idő arra, hogy megírjam ezt a bemutató cikket a canvasról és&nbsp;főleg a rajzolási állapotokról. Viszont a cikk olyan lesz, mint a felső oktatás, csupa elmélet semmi gyakorlat. :D<br />Viszont fogok majd a cikk végén plusz anyagot berakni és egy feladatot.<br /><br /><u><b>Canvas&nbsp;létrehozása:</b></u><br /><br />A canvas ugyan úgy viselkedik, mint bármelyik HTML elem ezért 2 fajta módon lehet&nbsp;létrehozni.<br /><br />1.statikusan:&nbsp;Ilyenkor&nbsp;egyszerűen csak&nbsp;belefűzzük&nbsp;a HTML dokumentumunkba azt ,hogy(body után):<br /><br />&lt;canvas id="myCanvas" width="300" height="200"&gt;&lt;/canvas&gt;<br /><br />Ebben az esetben kapunk egy 300x200-as méretű canvast.<br /><br />2.dinamikus: Ebben az esetben JS kód&nbsp;segítségével&nbsp;kreálunk&nbsp;egy canvas elemet, amit aztán beszúrunk a HTML dokumentumunkba.<br /><div><br /></div>var canvas = document.createElement('canvas');<br /><div>canvas.id = "myCanvas";&nbsp;</div><div>canvas.width = 300;&nbsp;</div><div>canvas.height = 200;</div>document.body.appendChild(canvas);<br /><div><br /></div><div>Először létrehozzuk a canvas elemet, majd&nbsp;beállítjuk&nbsp;az id-jét, &nbsp;szélességét&nbsp;és magasságát. Ezután pedig hozzá csatoljuk a HTML dokumentumunkhoz.</div><div><br /></div><div>Ezekből az esetekből is&nbsp;kitűnik&nbsp; hogy a kezelése ugyan olyan, mint ha bármelyik más HTML elemmel szórakoztunk volna.</div><div><br /></div><div><b><u>Canvas&nbsp;begyütése&nbsp;és a 2D Context:</u></b></div><div><br />Ahhoz, hogy a Canvasra rajzolni is tudjunk&nbsp;először meg kell szerezni a canvas elemet majd ettől az elemtől megszerezni annak a 2D contextusát.&nbsp; Ami így nézz ki:</div><div><div><br /></div><div>var canvas = document.getElementById('myCanvas');</div><div>var context = canvas.getContext('2d');</div></div><div><br /></div><div>De jöhet a kérdés, hogy mi az istenverése az a&nbsp;kontesztus(context)? Kontesztus, ahogy a nevéből egyeseknek&nbsp;kijön&nbsp;a rajzolási környezetet adja meg,(Például, hogy milyen színnel rajzolunk ,ami pedig az aktuális rajzolási&nbsp;állapothoz&nbsp;tartozó változó(strokeStyle)). W3C dokumentáció szerint a kontextus egy verem is egyben, ami rajzolási állapotokat(drawing state) tárol.<br />Megjegyzés:A verem egy adatszerkezet, ami adatokat egymás tetejére rakja és kivételnél mindig a legfelső adatot veszi le.&nbsp;Bővebben&nbsp;<a href="http://hu.wikipedia.org/wiki/Verem_(adatszerkezet)">itt</a>.<br /><br />Kontesztus gyakorlatilag az aktuális rajzolási állapot. Emelet a kontesztus egy veremnyi rajzolási állapot &nbsp;is tárol, de mi az a rajzolási állapot?</div><div><br /></div><div><b><u>Rajzolási állapot(drawing state):</u></b></div><div><b><u><br /></u></b></div><div>A rajzolási állapot gyakorlatilag egy tároló,ami a következőket tárolja:</div><div><ul><li>aktuális transzformációs mátrix</li><li>aktuális clipping region(kivágott régió)</li><li>egy rakat (stílus) változó értékét: &nbsp;strokeStyle,&nbsp;fillStyle,&nbsp;globalAlpha,&nbsp;lineWidth,&nbsp;lineCap,&nbsp;lineJoin,miterLimit,&nbsp;shadowOffsetX,&nbsp;shadowOffsetY,&nbsp;shadowBlur,&nbsp;shadowColor,&nbsp;globalCompositeOperation,&nbsp;font,textAlign, &nbsp; &nbsp;textBaseline.</li></ul></div><div>Transzformációs mátrix értelmezésébe nem mennék bele, mert már&nbsp;valamennyire&nbsp;elfelejtettem, hogy pontosan mit jelentenek. De emlékeimből az jön le, hogy&nbsp;ezek&nbsp;segítségével&nbsp;tudtunk&nbsp;&nbsp;nagyítani, forgatni, mozgatni alakzatokat. Akit érdekel az nézze meg <a href="http://people.bath.ac.uk/sej20/transform.html">ezt</a>.<br />A lényege, hogy ha ezzel a transzformációs mátrixszal&nbsp;beszorozzuk&nbsp;egy alakzatot, ami szintén egy mátrix(ebben az esetben a mátrix elemei az alakzat koordinátái lesznek), akkor az&nbsp;előbb&nbsp;felsorolt&nbsp;műveleteket&nbsp;tudjuk elvégezni rajta.&nbsp; Sőt saját transzformációs mátrixszal általunk kigondolt&nbsp;átalakítást&nbsp;is tudunk végezni.</div><div><br /></div><div>A kivágott régió pedig a rajzolási területet&nbsp;szűkíti&nbsp;le arra a területre, amit megadunk neki.<br />Ezért csak azon a régión belül tudunk rajzolni.</div><div><br /></div><div>Amit felsoroltam változókkal tudjunk befolyásolni a rajzolás stílusát. Például strokeStyle&nbsp;beállítja&nbsp; hogy milyen színnel húzza ki az alakzatot. pl.: context.strokeStyle="green" zöldre&nbsp;állítjuk az "ecsetünket".</div><div><br /></div><div>Ezekből látszik, hogy a rajzolási állapot befolyásolja azt, hogy milyen stílusban rajzolunk meg bármit a canvason és ennek a&nbsp;változtatás&nbsp;bonyodalmakhoz vezethet ha nem kezeljük jól a rajzolási állapotokat.</div><div>Például elfelejtem, hogy megváltoztattam a rajzolásnak a színét és ezért a többi alakzatot is olyan színnel rajzolom meg.</div><div><br /></div><div><b><u>Rajzolási állapottal való munka:</u></b></div><div><b><u><br /></u></b></div><div>Tehát nagyon fontos az, hogy jól kezeljük ezeket az állapotokat, mivel több is lehet. A kontextusnál írtam, hogy az egy verem és mint minden egyes veremnek ennek is kell, hogy legyen két&nbsp;művelete.</div><div><br /></div><div>context.save(); &nbsp; lementi az adott rajzolási állapotot a context verembe</div><div><br /></div><div>context.restore(); &nbsp;context verem tetejéről leszedi a legutoljára elmentett rajzolási állapotot</div><div><br /></div><div>Ezzel a két egyszerű&nbsp;művelettel&nbsp;tudunk sokkal biztonságosan rajzolni. Azért is írom ide a cikk elején, mert nagyon fontosnak tartom, hogy minden nagyobb rajzolás&nbsp;előtt&nbsp;mentsük le az alapértelmezett rajzolási állapotot és rajzolás után pedig hozzuk ezt az alap állapotot vissza.</div><div>Ez azért jó, mert minden rajzolást az alap állapotból tudunk megkezdeni és nem fogja meglepetés érni az embert. Így érdemes használni:</div><div><br /></div><div>context.save();</div><div>//ITT rajzolgatok</div><div>context.restore();</div><div><br /></div><div>Persze lehet őket bátran máshogy is használni, ha az ember megértette a&nbsp;működésüket.<br />Ahogy nézzem a dokumentációt, amit lent linkeltem be. Stílusok&nbsp;elkülönítését&nbsp;DrawingStyle objektummal is meg lehet oldani, viszont sokkal kevesebb stílus változóra van hatással.<br />Ezért ha biztos&nbsp;akarsz&nbsp;lenni, akkor használj rajzolási állapotot.<br /><br /><b><u>Néhány plusz anyag canvas tanuláshoz:</u></b><br /><br />Ezt a három tutorialt tartom az egyik legjobbaknak a témában:<br /><a href="http://www.html5canvastutorials.com/tutorials/html5-canvas-tutorials-introduction/">http://www.html5canvastutorials.com/tutorials/html5-canvas-tutorials-introduction/</a><br /><a href="http://diveintohtml5.info/canvas.html">http://diveintohtml5.info/canvas.html</a><br /><a href="https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial">https://developer.mozilla.org/en-US/docs/Web/Guide/HTML/Canvas_tutorial</a><br /><br />Dokumentáció, amiben minden benne van:<br /><a href="http://www.w3.org/html/wg/drafts/2dcontext/html5_canvas_CR/Overview.html">http://www.w3.org/html/wg/drafts/2dcontext/html5_canvas_CR/Overview.html</a><br /><br />Könyv, amit tudok a témában ajánlani az a <b>HTML5 Canvas</b>-nak a második kiadása, ami ebben az évben jelent meg és O'Reilly adta ki. Ebben a könyveben minden benne van, ami csak kapcsolódhat a canvashoz és a HTML5 játék&nbsp;készítéshez.<br />Sajnos még csak az elejébe volt időm beleolvasni, de nem csalódtam benne. <a href="http://www.amazon.com/HTML5-Canvas-Steve-Fulton/dp/1449334989/ref=la_B006X1HO1S_1_1?s=books&amp;ie=UTF8&amp;qid=1384620912&amp;sr=1-1">Amazon link</a><br /><br />Ha a tutorialokkal megvagyunk , akkor jöhet egy kis feladat:<br /><u><b>Feladat:</b></u><br />Aki esetleg még mindig gondolkozik egy táblás játék&nbsp;elkészítésén, annak érdemes a tábla rajzolásának a&nbsp;megvalósításán&nbsp;gondolkoznia.&nbsp;Először ajánlom, hogy statikusan vagyis előremegadott méretű tábla megrajzolásával foglalkozunk és ha ezzel meg vagyunk lehet a tábla egyre dinamikusabb vagyis a tábla mérete egy változótól függ. Majd a tábla nagysága függjön tényleges &nbsp;a képernyő méretétől, hogy mind kis és nagy képernyőn jól jelenjen meg.<br /><br />Kirajzolás kigondolásához érdemes&nbsp;előbb papíron megrajzolni, hogy miből is áll egy tábla és ez alapján el is lehet indulni.<br />Ezért is jók a táblás játékok, mert könnyebb őket megrajzolni, mint más játékokat.<br />Kezdésnek tökéletesek.<br /><br /></div><div><u><b>Összességében</b></u> nem tudtam vagy csak nem volt kedvem&nbsp;összehozni azt a fajta összefoglaló tutorialt, amit&nbsp;akartam&nbsp;ezért&nbsp;valószínűleg ennek a cikknek még lesznek folytatásai, ha lesz rá időm.<br />Na meg már annyi anyag van fent az interneten, hogy nem is tartom fontosnak, hogy csináljak egy sajátot. Viszont a rajzolási állapotok tisztázása szerintem nagyon fontos, ahhoz hogy az ember összetett rajzokat tudjon&nbsp;készíteni.</div><div><br /></div>